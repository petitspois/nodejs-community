/*!
 * coolie 苦力
 * @author ydr.me
 * @version 0.4.0
 * @license MIT
 */
!function(){"use strict";function e(e,o){var c,u,l,d={};2===arguments.length?(l=e,d._isAnonymous=!1,d._id=o,d._type="ajax",d._path=s(o),d._deps=[],d._factory=function(e,n,t){t.exports=l.responseText||"",l=null},n(d),P[d._id]=d,I[d._id]={}):z.length&&(u=e,c=z.shift(),d._isAnonymous=""===c[0],d._id=c[0]||u.id,d._type=c[0]?"local":"script",u=null,d._path=d._isAnonymous?s(d._id):"",d._deps=c[1],d._factory=c[2],n(d),P[d._id]=d,I[d._id]={},d._deps.length&&m(d._deps,function(e,n){var t=n.replace(S,""),o=d._isAnonymous?a(d._path,t):t;if(I[o]&&I[o][d._id])throw"module `"+d._id+"` and module `"+o+"` make up a circular dependency relationship";d._deps[e]=o,I[d._id][o]=1,F.push({id:o,by:d._id}),I[o]||(I[o]={},S.test(n)?i(o):r(o))})),U===X&&!z.length&&v&&P[v]&&(m(F,function(e,n){if(!I[n.id])throw"can not found module `"+n.id+"`, but module `"+n.by+"` dependence on it"}),t(v),I=null,z=null,F=null)}function n(e){e.exports={},e._exec=function(){var n=function(n){var t=e._isAnonymous?a(s(e._id),o(n)):n;if(!P[t])throw"can not found module `"+t+"`, require in `"+e._id+"`";return P[t]._exec()};return function(){var t=e._id;return e._hasExport?P[t].exports:(e._hasExport=!0,P[t].exports=e._factory.call(window,n,e.exports,e)||e.exports,P[t].exports)}}()}function t(e){if(!P[e])throw"can not found module `"+e+"`";console.log("past "+(Date.now()-y)+" ms"),console.groupEnd("coolie modules"),P[e]._exec(),f(coolie.callback)&&coolie.callback(P[e].exports)}function o(e){if(S.test(e))return e.replace(q,"").replace(S,"");if(e.indexOf("?")>-1)return e;var n=e.slice(-1);switch(n){case"#":return e.slice(0,-1);case"/":return e+"index.js";default:return L.test(e)?e:e+".js"}}function r(n){n=o(n);var t,r,i=c(n),s=Date.now(),a=h(n);return U++,i?(t=document.createElement("script"),r=function(n){N.removeChild(t),"error"===n.type?console.groupEnd("coolie modules"):(console.log("script module",a,Date.now()-s+"ms"),X++,e(t))},t.id=n,t.async=!0,t.defer=!0,t.src=a,t.onload=t.onerror=r,void N.appendChild(t)):setTimeout(function(){console.log("local module",a,Date.now()-s+"ms"),X++,e()},1)}function i(n){U++;var t=new XMLHttpRequest,o=Date.now(),r=function(){if(200!==t.status&&304!==t.status)throw"can not ajax "+n+", response status is "+t.status;console.log("text module",n,Date.now()-o+"ms"),X++,e(t,n)};t.onload=t.onerror=t.onabort=t.ontimeout=r,t.open("GET",n),t.send(null)}function s(e){return e.replace($,"/")}function c(e){return(e.replace(S,"").replace(T,"").match(A)||[""])[0]}function a(e,n){var t=(e.match(T)||[""])[0],o=c(e),r=c(n),i=0,s=e.replace(T,""),a=n;switch(o||(s="./"+s),"/"!==s.slice(-1)&&(s+="/"),r||(a="./"+a,r="./"),r){case"./":return t+s+a.slice(2);case"../":for(i=a.match(D).length;i-->0;){if(!k.test(s))throw"can not change path from `"+e+"` to `"+n+"`";s=s.replace(k,"")}return t+s+a.replace(D,"");default:return t+a}}function u(e){var n=[];return e.replace(j,"").replace(E,function(e,t,o){o&&n.push(o)}),n}function l(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function d(e){return"array"===l(e)}function f(e){return"function"===l(e)}function p(e){return"string"===l(e)}function m(e,n){var t,o;if(d(e))for(t=0,o=e.length;o>t&&n(t,e[t])!==!1;t++);else if("object"==typeof e)for(t in e)if(e.hasOwnProperty(t)&&n(t,e[t])===!1)break}function h(e){var n,t,o,r=l(H.version);switch(r){case"string":return e+(e.indexOf("?")>-1?"&":"?")+"_="+encodeURIComponent(H.version);case"object":return n=e.replace(H.base,""),o=(e.match(C)||[""])[0],t=H.version[n]||H.version["./"+n],t?e.replace(C,"").replace(O,"."+t+"$1")+o:e;default:return e}}function w(){var e=document.getElementsByTagName("script");return e[e.length-1]}function _(e,n){return e.getAttribute("data-"+n)}var g,b,v,y,x="0.4.0",E=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,j=/\\\\/g,D=/\.\.\//g,$=/\/([^\/]+)$/,A=/^.*?\//,k=/[^\/]+\/$/,C=/\?.*$/,q=/[?#].*$/,O=/(\.[^.]*)$/,T=/^.*\/\/[^\/]*/,S=/^(css|html|text)!/i,L=/\.js$/i,M=w(),N=M.parentNode,R=location.protocol+"//"+location.host+s(a(s(location.pathname),M.getAttribute("src"))),B=_(M,"main"),G=_(M,"config"),H={base:R},I={},P={},U=0,X=0,z=[],F=[];window.define=function(e,n,t){var o=arguments,r=1===o.length;if(v||(r?v=g:(b=v=e,I={},I[b]={})),r)t=o[0],e="";else{if(!p(e))throw new Error("module id must be a string");if(f(o[1])&&(t=o[1],n=[]),!d(n))throw new Error("module defineModules must be an array")}if(!f(t))throw new Error("module factory must be a function");n=r?u(t.toString()):n,z.push([e,n,t])},window.coolie={version:x,modules:P,callback:null,config:function(e){return e=e||{},H.base=e.base?a(R,e.base):R,H.version=e.version,this},use:function(e){if(g)throw new Error("can not  execute `coolie.use` twice more");if(!p(H.base))throw new Error("coolie config `base` property must be a string");if(e&&!p(e))throw new Error("main module must be a string");return B&&B!==e&&(e&&console.warn("attribute main is `"+B+"`, but use main is `"+e+"`"),e=B),g=a(H.base,e),y=Date.now(),console.group("coolie modules"),r(g),this}},function(){if(G){var e=document.createElement("script"),n=a(R,G);e.src=n+"?_="+Date.now(),N.appendChild(e),console.log("load config",n)}}()}();