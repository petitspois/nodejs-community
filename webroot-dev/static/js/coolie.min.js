/*!
 * coolie 苦力
 * @author ydr.me
 * @version 0.5.1
 * @license MIT
 */
!function(){"use strict";function e(e,r){var o,s,l,d={};2===arguments.length?(l=e,d._isAnonymous=!1,d._id=r,d._type="ajax",d._path=a(r),d._deps=[],d._factory=function(e,t,n){n.exports=l.responseText||"",l=null},t(d),J[d._id]=d,F[d._id]={}):V.length&&(s=e,o=V.shift(),d._isAnonymous=""===o[0],d._id=o[0]||s.id,d._type=o[0]?"local":"script",s=null,d._path=d._isAnonymous?a(d._id):"",d._deps=o[1],d._factory=o[2],t(d),J[d._id]=d,F[d._id]={},d._deps.length&&h(d._deps,function(e,t){var n=t.replace(B,""),r=d._isAnonymous?c(d._path,n):n;if(F[r]&&F[r][d._id])throw"module `"+d._id+"` and module `"+r+"` make up a circular dependency relationship";d._deps[e]=r,F[d._id][r]=1,W.push({id:r,by:d._id}),F[r]||(F[r]={},B.test(t)?u(r):i(r))})),K===Q&&!V.length&&E&&J[E]&&(h(W,function(e,t){if(!F[t.id])throw"can not found module `"+t.id+"`, but module `"+t.by+"` dependence on it"}),n(E),F=null,V=null,W=null)}function t(e){e.exports={},e._exec=function(){var t=function(t){var n=e._isAnonymous?c(a(e._id),r(t)):t;if(!J[n])throw"can not found module `"+n+"`, but required in `"+e._id+"`";return J[n]._exec()};return function(){var n=e._id;return e._hasExport?J[n].exports:(e._hasExport=!0,J[n].exports=e._factory.call(window,t,e.exports,e)||e.exports,J[n].exports)}}()}function n(e){if(!J[e])throw"can not found module `"+e+"`";Y.log("past "+(y()-j)+" ms"),Y.groupEnd("coolie modules"),J[e]._exec(),p(coolie.callback)&&coolie.callback(J[e].exports)}function r(e){if(B.test(e))return e.replace(L,"").replace(B,"");if(e.indexOf("?")>-1)return e;var t=e.slice(-1);switch(t){case"#":return e.slice(0,-1);case"/":return e+"index.js";default:return D.test(e)?e:e+".js"}}function o(e,t,n){var r=document.createElement("script"),o=function(){I.removeChild(r),p(t)&&t.apply(this,arguments)};r.id=n,r.src=e,r.async=!0,r.defer=!0,I.appendChild(r),H?r.onload=o:r.onreadystatechange=function(){/loaded|complete/.test(r.readyState)&&o.call(this,arguments)},r.onerror=o}function i(t){t=r(t);var n=s(t),i=y(),u=g(t);return K++,n?void o(u,function(t){"error"===t.type?Y.groupEnd("coolie modules"):(Y.log("script module",u,y()-i+"ms"),Q++,e(this))},t):setTimeout(function(){Y.log("local module",u,y()-i+"ms"),Q++,e()},1)}function u(t){K++;var n,r=new XMLHttpRequest,o=y(),i=function(){if(4===r.readyState&&!n){if(n=!0,200!==r.status&&304!==r.status)throw"can not ajax "+t+", response status is "+r.status;Y.log("text module",t,y()-o+"ms"),Q++,e(r,t)}};r.onload=r.onreadystatechange=r.onerror=r.onabort=r.ontimeout=i,r.open("GET",t),r.send(null)}function a(e){return e.replace(T,"/")}function s(e){var t;return R.test(e)?(t=e.match(R),t[1]||"//"):(e.replace(B,"").match(q)||[""])[0]}function c(e,t){var n=(e.match(R)||[""])[0],r=s(e),o=s(t),i=0,u=e.replace(R,""),a=t;if(R.test(o))return N.test(t)?t:location.protocol+t;switch(r||(u="./"+u),"/"!==u.slice(-1)&&(u+="/"),o||(a="./"+a,o="./"),o){case"./":return n+u+a.slice(2);case"../":for(i=a.match(S).length;i-->0;){if(!C.test(u))throw"can not change path from `"+e+"` to `"+t+"`";u=u.replace(C,"")}return n+u+a.replace(S,"");default:return n+a}}function l(e){var t=[];return e.replace(k,"").replace($,function(e,n,r){r&&t.push(r)}),t}function d(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function f(e){return"array"===d(e)}function p(e){return"function"===d(e)}function m(e){return"string"===d(e)}function h(e,t){var n,r;if(f(e))for(n=0,r=e.length;r>n&&t(n,e[n])!==!1;n++);else if("object"==typeof e)for(n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)break}function g(e){var t,n,r,o=d(z.version);switch(o){case"string":return e+(e.indexOf("?")>-1?"&":"?")+"_="+encodeURIComponent(z.version);case"object":return t=e.replace(z.base,""),r=(e.match(O)||[""])[0],n=z.version[t]||z.version["./"+t],n?e.replace(O,"").replace(M,"."+n+"$1")+r:e;default:return e}}function _(){var e=document.getElementsByTagName("script");return e[e.length-1]}function w(e){return e.hasAttribute?e.src:e.getAttribute("src",4)}function b(e,t){return e.getAttribute("data-"+t)}function y(){return(new Date).getTime()}var v,x,E,j,A="0.5.1",$=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,k=/\\\\/g,S=/\.\.\//g,T=/\/([^\/]+)$/,q=/^.*?\//,C=/[^\/]+\/$/,O=/\?.*$/,L=/[?#].*$/,M=/(\.[^.]*)$/,N=/^https?:/i,R=/^(.*)\/\/[^/]*/,B=/^(css|html|text)!/i,D=/\.js$/i,G=_(),H="onload"in G,I=G.parentNode,P=a(w(G)),U=b(G,"main"),X=b(G,"config"),z={base:P},F={},J={},K=0,Q=0,V=[],W=[],Y=function(){var e={},t=window.console,n=["log","warn","group","groupEnd"];return h(n,function(n,r){e[r]=function(){if(t&&t[r])try{t[r].apply(t,arguments)}catch(e){}}}),e}();window.define=function(e,t,n){var r=arguments,o=1===r.length;if(E||(o?E=v:(x=E=e,F={},F[x]={})),o)n=r[0],e="";else{if(!m(e))throw"module id must be a string";if(p(r[1])&&(n=r[1],t=[]),!f(t))throw"module defineModules must be an array"}if(!p(n))throw"module factory must be a function";t=o?l(n.toString()):t,V.push([e,t,n])},window.define.amd=!0,window.define.cmd=!0,window.coolie={version:A,modules:J,callback:null,config:function(e){return e=e||{},z.base=e.base?c(P,e.base):P,z.version=e.version,this},use:function(e){if(v)throw new Error("can not  execute `coolie.use` twice more");if(!m(z.base))throw new Error("coolie config `base` property must be a string");if(e&&!m(e))throw new Error("main module must be a string");return U&&U!==e&&(e&&Y.warn("attribute main is `"+U+"`, but use main is `"+e+"`"),e=U),v=c(z.base,e),j=y(),Y.group("coolie modules"),i(v),this}},X&&o(c(P,X)+"?_="+y())}();