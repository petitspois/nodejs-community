/*!
 * coolie 苦力
 * @author ydr.me
 * @version 0.3.1
 * @license MIT
 */
!function(){"use strict";function e(e,o){var a,u,l,d={};2===arguments.length?(l=e,d._isAnonymous=!1,d._id=o,d._type="ajax",d._path=s(o),d._deps=[],d._factory=function(e,n,t){t.exports=l.responseText||"",l=null},n(d),I[d._id]=d,H[d._id]={}):X.length&&(u=e,a=X.shift(),d._isAnonymous=""===a[0],d._id=a[0]||u.id,d._type=a[0]?"local":"script",u=null,d._path=d._isAnonymous?s(d._id):"",d._deps=a[1],d._factory=a[2],n(d),I[d._id]=d,H[d._id]={},d._deps.length&&m(d._deps,function(e,n){var t=n.replace(S,""),o=d._isAnonymous?c(d._path,t):t;if(H[o]&&H[o][d._id])throw"module `"+d._id+"` and module `"+o+"` make up a circular dependency relationship";d._deps[e]=o,H[d._id][o]=1,z.push({id:o,by:d._id}),H[o]||(H[o]={},S.test(n)?i(o):r(o))})),P===U&&!X.length&&v&&I[v]&&(m(z,function(e,n){if(!H[n.id])throw"can not found module `"+n.id+"`, but module `"+n.by+"` dependence on it"}),t(v),H=null,X=null,z=null)}function n(e){e.exports={},e._exec=function(){var n=function(n){var t=e._isAnonymous?c(s(e._id),o(n)):n;if(!I[t])throw"can not found module `"+t+"`, require in `"+e._id+"`";return I[t]._exec()};return function(){var t=e._id;return e._hasExport?I[t].exports:(e._hasExport=!0,I[t].exports=e._factory.call(window,n,e.exports,e)||e.exports,I[t].exports)}}()}function t(e){if(!I[e])throw"can not found module `"+e+"`";console.log("past "+(Date.now()-y)+" ms"),console.groupEnd("coolie modules"),I[e]._exec(),f(coolie.callback)&&coolie.callback(I[e].exports)}function o(e){if(S.test(e))return e.replace(C,"").replace(S,"");if(e.indexOf("?")>-1)return e;var n=e.slice(-1);switch(n){case"#":return e.slice(0,-1);case"/":return e+"index.js";default:return L.test(e)?e:e+".js"}}function r(n){n=o(n);var t,r,i=a(n),s=Date.now(),c=h(n);return P++,i?(t=document.createElement("script"),r=function(n){N.removeChild(t),"error"===n.type?console.groupEnd("coolie modules"):(console.log("script module",c,Date.now()-s+"ms"),U++,e(t))},t.id=n,t.async=!0,t.defer=!0,t.src=c,t.onload=t.onerror=r,void N.appendChild(t)):setTimeout(function(){console.log("local module",c,Date.now()-s+"ms"),U++,e()},1)}function i(n){P++;var t=new XMLHttpRequest,o=Date.now(),r=function(){if(200!==t.status&&304!==t.status)throw"can not ajax "+n+", response status is "+t.status;console.log("text module",n,Date.now()-o+"ms"),U++,e(t,n)};t.onload=t.onerror=t.onabort=t.ontimeout=r,t.open("GET",n),t.send(null)}function s(e){return e.replace(A,"/")}function a(e){return(e.replace(S,"").replace(T,"").match(D)||[""])[0]}function c(e,n){var t=(e.match(T)||[""])[0],o=a(e),r=a(n),i=0,s=e.replace(T,""),c=n;switch(o||(s="./"+s),"/"!==s.slice(-1)&&(s+="/"),r||(c="./"+c,r="./"),r){case"./":return t+s+c.slice(2);case"../":for(i=c.match($).length;i-->0;){if(!k.test(s))throw"can not change path from `"+e+"` to `"+n+"`";s=s.replace(k,"")}return t+s+c.replace($,"");default:return t+c}}function u(e){var n=[];return e.replace(j,"").replace(E,function(e,t,o){o&&n.push(o)}),n}function l(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function d(e){return"array"===l(e)}function f(e){return"function"===l(e)}function p(e){return"string"===l(e)}function m(e,n){var t,o;if(d(e))for(t=0,o=e.length;o>t&&n(t,e[t])!==!1;t++);else if("object"==typeof e)for(t in e)if(e.hasOwnProperty(t)&&n(t,e[t])===!1)break}function h(e){var n,t,o,r=l(G.version);switch(r){case"string":return e+(e.indexOf("?")>-1?"&":"?")+"_="+encodeURIComponent(G.version);case"object":return n=e.replace(G.base,""),o=(e.match(q)||[""])[0],t=G.version[n]||G.version["./"+n],t?e.replace(q,"").replace(O,"."+t+"$1")+o:e;default:return e}}function w(){var e=document.getElementsByTagName("script");return e[e.length-1]}function _(e){return e.dataset?e.dataset.main:e.getAttribute("data-main")}var g,b,v,y,x="0.3.1",E=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,j=/\\\\/g,$=/\.\.\//g,A=/\/([^\/]+)$/,D=/^.*?\//,k=/[^\/]+\/$/,q=/\?.*$/,C=/[?#].*$/,O=/(\.[^.]*)$/,T=/^.*\/\/[^\/]*/,S=/^(css|html|text)!/i,L=/\.js$/i,M=w(),N=M.parentNode,R=location.protocol+"//"+location.host+s(c(s(location.pathname),M.getAttribute("src"))),B=_(M),G={base:R},H={},I={},P=0,U=0,X=[],z=[];window.define=function(e,n,t){var o=arguments,r=1===o.length;if(v||(r?v=g:(b=v=e,H={},H[b]={})),r)t=o[0],e="";else{if(!p(e))throw new Error("module id must be a string");if(f(o[1])&&(t=o[1],n=[]),!d(n))throw new Error("module defineModules must be an array")}if(!f(t))throw new Error("module factory must be a function");n=r?u(t.toString()):n,X.push([e,n,t])},window.coolie={version:x,modules:I,callback:null,config:function(e){return e=e||{},G.base=e.base?c(R,e.base):R,G.version=e.version,this},use:function(e){if(g)throw new Error("can not  execute `coolie.use` twice more");if(!p(G.base))throw new Error("coolie config `base` property must be a string");if(e&&!p(e))throw new Error("main module must be a string");return B&&B!==e&&(e&&console.warn("attribute main is `"+B+"`, but use main is `"+e+"`"),e=B),g=c(G.base,e),y=Date.now(),console.group("coolie modules"),r(g),this}}}();